
LPCHECK=lambdapi check -c --no-warnings

LPS=$(wildcard *.lp)
LPOS=$(patsubst %.lp, %.lpo, $(LPS))


noEta: replacePrim-noEta $(LPOS) num

eta: replacePrim-eta $(LPOS) num

# as generated by Agda2Dk, the translation of Primitive is broken
replacePrim-noEta:
	rm Agda__Primitive.lp && cp ../Agda__Primitive-noEta.lp Agda__Primitive.lp

replacePrim-eta:
	rm Agda__Primitive.lp && cp ../Agda__Primitive-eta.lp Agda__Primitive.lp


%.lpo:
	$(LPCHECK) $(patsubst %.lpo, %.lp, $@) || echo "Pb with " $(patsubst %.lpo, %.lp, $@)

num:
	echo "files typechecked: " && find . -name "*.lpo" | wc -l && echo "--" && find . -name "*.lp" | wc -l

clean:
	rm -f *.lp*

